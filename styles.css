/* ================== Base ================== */
:root{
  --bg: #0b0f14;
  --bg2:#0e131a;
  --card:#121821;
  --glass: rgba(255,255,255,.06);
  --glass-strong: rgba(255,255,255,.1);
  --stroke: rgba(255,255,255,.12);
  --muted: #9fb2c8;
  --text: #ecf5ff;
  --accent: #32d1ff;

  /* ขนาดการ์ดช่อง (ฐาน PC) */
  --tile-w: 92px;
  --tile-h: 104px;
  --tile-g: 10px;

  /* โลโก้ในช่อง (เว้นพื้นที่ให้ชื่อ 2 บรรทัด) */
  --logo-max-w: 68%;
  --logo-max-h: 48%;

  --player-radius: 18px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(1200px 600px at 50% -20%, #1e293b33 0, #0b0f1400 60%),
    linear-gradient(180deg,#0b0f14 0,#090c11 60%,#080a0e 100%);
  color:var(--text);
  font: 14px/1.4 system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Thai", "Noto Sans", Arial, sans-serif;
}

/* Scroll */
:root{scrollbar-color:#202733 transparent}
::-webkit-scrollbar{height:10px;width:10px}
::-webkit-scrollbar-thumb{background:#1f2631;border-radius:10px}

/* ================== Header ================== */
header{
  position:sticky; top:0; z-index:30;
  background:linear-gradient(180deg,#0b0f14f2 0,#0b0f1490 65%,transparent 100%);
  backdrop-filter: blur(6px);
}
.h-wrap{
  position:relative;
  max-width: 1120px;
  margin: 0 auto;
  padding: 10px 16px 6px;
  text-align:center;
}
.clock{
  font-weight:800;
  letter-spacing:.3px;
  text-shadow:0 1px 12px #0006;
}
.sub{
  margin-top:2px;
  font-size:12px;
  color:var(--muted);
}

/* แสดงชื่อช่องใต้เวลา (จะถูกเติมโดย JS หากไม่มี) */
#now-playing{
  margin-top:6px;
  font-size:13px;
  font-weight:700;
  color:#dff2ff;
  opacity:.95;
}

/* Histats badge (มุมขวาบนใน header) – ถ้ามี */
#histats_counter{position:absolute; top:6px; right:8px; pointer-events:none;}
#histatsC{transform:scale(.72); transform-origin:top right; filter:drop-shadow(0 2px 8px #000a);}
@media (max-width:640px){ #histatsC{transform:scale(.58);} }

/* ================== Player ================== */
.app{max-width:1120px;margin:0 auto;padding:8px 12px 24px}
#player{
  width:100%;
  aspect-ratio:16/9;
  background:linear-gradient(180deg,#0d131b,#0a0f15);
  border:1px solid var(--stroke);
  border-radius:var(--player-radius);
  overflow:hidden;
  box-shadow: 0 10px 36px rgba(0,0,0,.45), inset 0 1px 0 #ffffff10;
}

/* ================== Tabs (Glassmorphism) ================== */
.tabs{
  display:flex; gap:12px;
  padding:14px 4px 8px;
  margin: 8px auto 4px;
  overflow-x:auto; -webkit-overflow-scrolling:touch;
  scrollbar-width:none;
  justify-content:center;
  max-width:980px;
}
.tabs::-webkit-scrollbar{display:none}
.tab{ appearance:none; border:0; background:transparent; color:inherit; padding:0; cursor:pointer; outline:none; }
.tab-card{
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  width:98px; height:70px;
  background: var(--glass);
  border:1px solid var(--stroke);
  border-radius:14px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 4px 14px rgba(0,0,0,.35);
  backdrop-filter: blur(10px);
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
}
.tab:hover .tab-card{ transform: translateY(-2px); box-shadow: inset 0 1px 0 #ffffff10, 0 8px 22px rgba(0,0,0,.45); }
.tab[aria-selected="true"] .tab-card{
  background: linear-gradient(180deg, rgba(50,209,255,.20), rgba(50,209,255,.08));
  border-color: #46e2ff66;
  box-shadow: inset 0 1px 0 #aef2ff2e, 0 10px 26px rgba(19,166,216,.38);
  position:relative;
}
.tab[aria-selected="true"] .tab-card::after{
  content:""; position:absolute; left:10px; right:10px; bottom:6px; height:3px;
  border-radius:3px; background: linear-gradient(90deg, transparent, #52e2ff, transparent);
}
.tab-icon{ width:26px; height:26px; display:grid; place-items:center; margin-bottom:8px; color:#fff; opacity:.95;}
.tab-icon svg{width:100%;height:100%}
.tab-label{ font-size:13px; font-weight:700; letter-spacing:.2px; color:#eef6ff; text-shadow:0 1px 0 #0009 }

/* ================== Notices (ถ้ามี) ================== */
.notice-host{max-width:980px;margin:6px auto 6px;padding:0 4px}
.notice{
  display:flex; gap:10px; align-items:center; padding:10px 12px;
  border-radius:12px; border:1px solid var(--stroke);
  background: rgba(255,255,255,.04);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
  font-size:13px; color:#d9ecff;
}
.notice--info{ border-color:#46e2ff40; background:linear-gradient(180deg,rgba(50,209,255,.12),rgba(255,255,255,.02));}
.notice--error{ border-color:#ff5b6b40; background:linear-gradient(180deg,rgba(255,91,107,.12),rgba(255,255,255,.02));}

/* ================== Grid ช่อง ================== */
.grid{
  display:grid; gap:var(--tile-g);
  grid-template-columns: repeat(auto-fill, minmax(var(--tile-w), var(--tile-w)));
  grid-auto-rows: var(--tile-h);
  justify-content:center; align-content:start;
  margin-top:10px;
}
.channel{
  position:relative;
  width:var(--tile-w); height:var(--tile-h);
  cursor:pointer;
}
.ch-card{
  position:relative; overflow:hidden;  /* สำหรับ ripple */
  display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  width:100%; height:100%;
  padding:8px 6px 7px;
  border-radius:12px;
  background:linear-gradient(180deg, #111722, #0e141d);
  border:1px solid var(--stroke);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.05), 0 6px 18px rgba(0,0,0,.45);
  transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease, background .15s ease;
}
.channel:hover .ch-card{
  transform: translateY(-2px);
  box-shadow: inset 0 1px 0 #ffffff10, 0 10px 26px rgba(0,0,0,.55);
}

/* โลโก้ */
.ch-card img, .ch-logo, .logo{
  max-width:var(--logo-max-w);
  max-height:var(--logo-max-h);
  object-fit:contain; object-position:center;
  filter: drop-shadow(0 2px 8px rgba(0,0,0,.4));
}

/* หมวด “หนัง” โลโก้ยาว */
.channel[data-category="หนัง"] .ch-card img,
.channel[data-category="หนัง"] .ch-logo,
.channel[data-category="หนัง"] .logo{
  max-width:80%;
  max-height:42%;
}

/* ชื่อช่อง — เสมอกัน 2 บรรทัด ชิดล่างการ์ด */
.ch-name, .name{
  margin-top:auto;
  padding-top:6px;
  text-align:center;
  font-size:12px;
  line-height:1.30;
  height:calc(1.30em * 2 + 2px);
  color:#e8f2ff;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
  text-overflow:ellipsis;
  word-break: break-word;
  text-wrap: balance;
}

/* =========== เอฟเฟกต์ตอนกำลังเล่น + ripple =========== */
/* เรืองแสงตอนกำลังเล่น */
.channel.playing .ch-card{
  background: linear-gradient(180deg,#161e2b,#111926);
  border-color:#fff;
  box-shadow:
    inset 0 0 0 1px #ffffff80,
    0 0 0 2px #ffffff33,
    0 10px 28px rgba(255,255,255,.22),
    0 0 30px 10px rgba(255,255,255,.16);
}
/* pulse light ring */
.channel.playing .ch-card::before{
  content:""; position:absolute; inset:-2px; border-radius:inherit; pointer-events:none;
  box-shadow:0 0 0 0 rgba(255,255,255,.35);
  animation: cardPulse 1.6s ease-out infinite;
}
@keyframes cardPulse{
  0%   { box-shadow:0 0 0 0 rgba(255,255,255,.35); }
  70%  { box-shadow:0 0 0 10px rgba(255,255,255,0); }
  100% { box-shadow:0 0 0 10px rgba(255,255,255,0); }
}
/* ripple ตอนแตะ/คลิก */
.channel.pressed .ch-card::after{
  content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
  background:
    radial-gradient(circle at var(--x,50%) var(--y,50%),
      rgba(255,255,255,.35) 0%,
      rgba(255,255,255,.22) 18%,
      rgba(255,255,255,.00) 60%);
  animation: cardRipple 550ms ease-out forwards;
}
@keyframes cardRipple{
  0%   { opacity:.85; transform:scale(1); }
  100% { opacity:0;  transform:scale(1.1); }
}
@media (prefers-reduced-motion: reduce){
  .channel.playing .ch-card::before,
  .channel.pressed .ch-card::after{ animation:none }
}

/* เอฟเฟกต์รวมการ์ดตอนกรอง */
.grid.filtering .channel{ animation:tile-pop .22s ease both }
@keyframes tile-pop{
  from{ transform:scale(.96); opacity:.0 }
  to{ transform:scale(1); opacity:1 }
}

/* Tip */
.tip{
  margin: 10px auto 0;
  max-width: 980px;
  text-align:center;
  color:#a7b9cd; font-size:12px; opacity:.9;
}

/* ================== Responsive ================== */
@media (max-width:1200px){
  :root{ --tile-w: 90px; --tile-h: 102px; --tile-g: 10px }
}
@media (max-width:900px){
  :root{ --tile-w: 88px; --tile-h: 100px; --tile-g: 9px }
  .tab-card{ width:96px; height:68px }
}
@media (max-width:640px){
  :root{ --tile-w: 86px; --tile-h: 98px; --tile-g: 8px }
  .app{padding:8px 10px 24px}
  .tab-card{ width:92px; height:66px }
  .tab-icon{ width:24px; height:24px; margin-bottom:7px }
  .tab-label{ font-size:12.8px }
}
@media (max-width:390px){
  :root{ --tile-w: 84px; --tile-h: 96px; --tile-g: 8px }
  .tab-card{ width:90px; height:64px }
  .tab-icon{ width:23px; height:23px }
}
@media (max-height:420px) and (orientation:landscape){
  :root{ --tile-h: 94px }
}

/* ====== Toast ชื่อช่องบนวิดีโอ (มือถือ) ====== */
#mini-toast{
  position:absolute; z-index:5; left:12px; bottom:12px;
  padding:6px 10px; border-radius:10px;
  background:rgba(0,0,0,.55); color:#fff; font-weight:700; font-size:12px;
  backdrop-filter: blur(2px);
  transform: translateY(8px); opacity:0; pointer-events:none;
  transition: .25s ease;
}
#mini-toast.show{ transform:none; opacity:1 }
